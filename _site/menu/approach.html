<!doctype html>

<html>

<head>

  <title>
    
      P2V Methodology | Product2Vec
    
  </title>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8">

  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="/assets/css/syntax.css">
  <!-- Use Atom -->
  <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Product2Vec" />
  <!-- Use RSS-2.0 -->
  <!--<link href="/rss-feed.xml" type="application/rss+xml" rel="alternate" title="Product2Vec | "/>
  //-->

  <link rel="stylesheet" href="/assets/css/academicons.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Quattrocento+Sans">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono|Roboto+Slab:300|Roboto:400">

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
    MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
      });
  </script>

  <!-- Google Analytics -->
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');
</script>


  <!-- Use Jekyll SEO plugin -->
  <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>P2V Methodology | Product2Vec</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="P2V Methodology" />
<meta name="author" content="Sebastian Gabel" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/menu/approach.html" />
<meta property="og:url" content="http://localhost:4000/menu/approach.html" />
<meta property="og:site_name" content="Product2Vec" />
<script type="application/ld+json">
{"url":"http://localhost:4000/menu/approach.html","author":{"@type":"Person","name":"Sebastian Gabel"},"headline":"P2V Methodology","@type":"WebPage","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


</head>


<body class="Site">

  <main class="Site-content">

    <div class="container">

      <header class="masthead">
  <h3 class="masthead-title">
    <a href="/">Product2Vec</a>
    <small class="masthead-subtitle"></small>
    <div class="menu">
  <nav class="menu-content">
    
      <a href="/./index.html">Home</a>
    
      <a href="/menu/approach.html">Approach</a>
    
      <a href="/menu/case.html">Case Study</a>
    
      <a href="/menu/applications.html">Applications</a>
    
      <a href="/menu/related.html">Related Research</a>
    
      <a href="/menu/methods.html">Alternative Methods</a>
    
  </nav>
</div>

  </h3>
</header>


      <div class="post-container">
        <h2>
  P2V Methodology
</h2>

  <p style="margin-top: 2em;">The Product2Vec model analyzes co-occurrences of products in
shopping baskets. The idea is that products that frequently appear together in customer
transactions (i.e., items bought in the same shopping trip) likely share some hidden, or
latent, attributes. For example, if hot dogs and hot dog buns often appear together in
baskets, the model interprets them as related, even without explicit knowledge of their
categories. In addition, the model understand products' similarity if the products occur
in similar shopping baskets, even if they never, or very rarely, occur together (e.g., two
different detergents brands). By doing this for large datasets of transactions, P2V
automatically identifies relationships across a retailer’s full assortment.</p>

<div style="float: left;">
<img src="/assets/img/vector.png" width="250" />
</div>

<p>Each product is represented by D-dimensional vector. P2V generates product vectors by
training a neural network model using market basket data. The training task is framed as
a binary classification problem, where the model learns to predict whether two products
co-occur in the same basket. For each product pair, the model produces a similarity score,
and the training objective is to classify product pairs as either co-occurring (positive
samples) or not co-occurring (negative samples).  The loss function used is the binary
cross-entropy loss, which penalizes incorrect predictions based on the dot product of the
product vectors. The learning procedure involves stochastic gradient descent (SGD), where
product vectors are iteratively updated to minimize the classification error. Negative
sampling is employed to efficiently handle the large number of product pairs that do not
co-occur, ensuring scalability to large datasets.</p>

<h3>Fun with Product Vectors</h3>

<p>To illustrate that product vectors capture meaningful information, consider the following
example. We take the product vector for <code class="language-plaintext highlighter-rouge">Diet Coke</code>, add the product vector for <code class="language-plaintext highlighter-rouge">Gilette
Fusion</code> razor blades, and subtract the product vector for <code class="language-plaintext highlighter-rouge">Gilette Venus</code> razor blades.
Out of more than 30,000 product vectors, the vector most similar to <code class="language-plaintext highlighter-rouge">Diet Coke + Gilette
Fusion - Gilette Venus</code> is <code class="language-plaintext highlighter-rouge">Coke Zero</code>. Both difference, <code class="language-plaintext highlighter-rouge">Coke Zero - Diet Coke</code> and
<code class="language-plaintext highlighter-rouge">Gilette Fusion - Gilette Venus</code> capture the different in the products’ target audience.</p>

<div style="float: left; margin-bottom: 2em;">
<img src="/assets/img/analogy.png" width="800" />
</div>

<p>The table below illustrates that similar calculations work for a variety of other product
characteristics, such as packaging size, private label, gluten-free and so on.</p>

<table class="styled-table">
    <thead>
        <tr>
            <th>Attribute</th>
            <th>Product A</th>
            <th>Product B</th>
            <th>Product C</th>
            <th>Product D</th>
        </tr>
    </thead>
    <tbody>
    <!--
        <tr>
        <th>Female</th>
        <th>Coca-Cola Zero 1l</th>
        <th>Gillette Venus blades</th>
        <th>Gillette Fusion blades</th>
        <th>Diet Coke 1l</th>
        </tr>
    -->
        <tr>
        <td>Low-calorie</td>
        <td>Fanta Orange 1l</td>
        <td>Coca-Cola Zero 2l</td>
        <td>Coca-Cola 2l</td>
        <td>Fanta Orange Zero 1l</td>
        </tr>
        <tr>
        <td>Frozen</td>
        <td>Mars 6pc</td>
        <td>Snickers ice cream 6pc</td>
        <td>Snickers 6pc</td>
        <td>Mars ice cream 6pc</td>
        </tr>
        <tr>
        <td>Organic</td>
        <td>Bananas</td>
        <td>Onions red 500g organic</td>
        <td>Onions red 500g</td>
        <td>Bananas organic</td>
        </tr>
        <tr>
        <td>Private label</td>
        <td>Jacobs coffee pads 16pc</td>
        <td>PL coffee 500g</td>
        <td>Jacobs coffee 500g</td>
        <td>PL coffee pads 20pc</td>
        </tr>
        <tr>
        <td>Alcohol-free</td>
        <td>Krombacher Pilsner .33l</td>
        <td>Rotkäppchen .75l alcohol free</td>
        <td>Rotkäppchen .75l</td>
        <td>Krombacher Pilsner .33l alcohol free</td>
        </tr>
        <tr>
        <td>Low-fat</td>
        <td>Geramont camembert 200g 60% fat</td>
        <td>Bärenmarke milk 1l 1.5% fat</td>
        <td>Bärenmarke milk 1l 3.8% fat</td>
        <td>Geramont camembert 200g light 16% fat</td>
        </tr>
        <tr>
        <td>Gluten-free</td>
        <td>Leibniz biscuits 200g</td>
        <td>Dr. Schär Zwieback 165g</td>
        <td>Brandt Zwieback 225g</td>
        <td>Dr. Schär biscuits 165g</td>
        </tr>
        <tr>
        <td>Lactose-free</td>
        <td>Bärenmarke whipping cream 32%</td>
        <td>Minus L(actose) coffee creamers 10%</td>
        <td>Bärenmarke 8% coffee creamers</td>
        <td>Minus L(actose) whipping cream 33%</td>
        </tr>
        <tr>
        <td>Vegetarian</td>
        <td>Rügenwalder bologna 80g</td>
        <td>Mühlen meatballs 165g vegetarian</td>
        <td>Mühlen meatballs 165g</td>
        <td>Rügenwalder bologna 80g vegetarian</td>
        </tr>
        <tr>
        <td>Flavor</td>
        <td>Landliebe yogurt 150g strawberry</td>
        <td>Schwartau jam 340g cherry</td>
        <td>Schwartau jam 340g strawberry</td>
        <td>Landliebe yogurt 150g cherry</td>
        </tr>
        <tr>
        <td>Category</td>
        <td>Cherry tomatoes 250g</td>
        <td>PL carrot juice .5l</td>
        <td>Carrots</td>
        <td>PL tomato juice .5l JP</td>
        </tr>
        <tr>
        <td>Size</td>
        <td>JP Chenet Syrah .75l</td>
        <td>Rotkäppchen .25l</td>
        <td>Rotkäppchen .75l</td>
        <td>Chenet Syrah .25l</td>
        </tr>
        <tr>
        <td>Multi-pack</td>
        <td>Hohes C multivitamins 1l</td>
        <td>Hohes C orange 3x.2l</td>
        <td>Hohes C orange 1l</td>
        <td>Hohes C multivitamins 3x.2l</td>
        </tr>
        <tr>
        <td>Packaging</td>
        <td>Italian parsley 50g bunch</td>
        <td>French parsley 40g flowpack</td>
        <td>French parsley 50g bunch</td>
        <td>Italian parsley 40g flowpack</td>
        </tr>
        <tr>
        <td>Season</td>
        <td>Lindt Easter bunny 100g</td>
        <td>Merci Santa Claus 120g</td>
        <td>Merci Easter bunny 120g</td>
        <td>Lindt Santa Claus 70g</td>
        </tr>
    </tbody>
</table>



      </div>

    </div>

  </main>

  <footer class="footer">
  <!--

  
  
    <a href="https://www.github.com/sbstn-gbl/p2v-map" target="_blank"><i class="fa fa-github" aria-hidden="true"></i></a>
  

  
  
    <a href="mailto:gabel@rsm.nl" target="_blank"><i class="fa fa-envelope" aria-hidden="true"></i></a>
  

-->

  
    <a href="https://www.github.com/sbstn-gbl/p2v-map" class="menu-link" target="_blank"><i class="fa fa-github" aria-hidden="true"></i></a>
  

  
    <a href="mailto:gabel@rsm.nl" class="menu-link" target="_blank"><i class="fa fa-envelope" aria-hidden="true"></i></a>
  


  <div class="post-date"><a href="/index.html">Product2Vec &#8287; | &#8287; 2019–2024 </a></div>
</footer>


</body>

</html>
